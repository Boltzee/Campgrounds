<% layout('layouts/boilerplate') %>
<link rel="stylesheet" href="/css/map.css">
<body>
	<% let k ="https://res.cloudinary.com/chadchampion/image/upload/v1616938179/YelpCamp/onsqcoe4194je2pxi5jm.jpg"%>
	<div id="map" class="cluster-map"></div>
	<h1 id="first-heading">Campgrounds</h1>
		<% for(let x of grounds) {%>
		    <div class="card mb-3" data-src="<%=(x.images.length > 0)? x.images[0].url : k%>">
		    	
		    </div>
		<%}%>
	<a href="/campgrounds/new">Add a new campground</a>
	<script>
		const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
		const campgrounds = { features: <%-JSON.stringify(grounds)%>};
	</script>
	<script src="/js/clusterMap.js"></script>
	<script>
		let cards = document.querySelectorAll('div.card');

		cards.forEach(card => {
			card.style.backgroundImage = `url(${card.dataset.src})`;
			card.style.backgroundRepeat = 'no-repeat';
			card.style.height = "39vw";	
		})	
	</script>	
</body>
